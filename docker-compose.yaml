services:
  backend:
    build:
      context: ./expressjs-and-rest-sri-nivas1227
    ports:
      - "5000:5000"
    networks:
      - app-net
  frontend:
    build:
      context: ./source-code
      args:
        REACT_APP_BACKEND_URL:
    depends_on:
      - backend
    volumes:
      - frontend-build:/app/build
    command: ["echo", "frontend built"]
    # networks:
    #   - app-net
  nginx:
    image: nginx:latest
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
      - frontend-build:/usr/share/nginx/html:ro
    depends_on:
      - frontend
    networks:
      - app-net
networks:
  app-net:
volumes:
  frontend-build:
